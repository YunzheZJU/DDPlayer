(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{143:function(t,i,e){},144:function(t,i,e){"use strict";var n=function(){var t=this.$createElement,i=this._self._c||t;return i("button",{directives:[{name:"title",rawName:"v-title"}],staticClass:"normal-button",class:{highlight:this.highlight,active:this.active}},[this.iconType?i("Icon",{staticClass:"icon",attrs:{type:this.iconType,size:"sm"}}):this._e(),this._v(" "),i("span",{staticClass:"title"},[this._t("default")],2)],1)};n._withStripped=!0;var s=e(9),a={name:"normal-button",components:{Icon:e(5).a},directives:{Title:s.a},props:{iconType:{type:String},active:{type:Boolean,default:!1},highlight:{type:Boolean,default:!1}}},o=(e(145),e(2)),l=Object(o.a)(a,n,[],!1,null,"1417b078",null);l.options.__file="src/components/common/normal-button.vue";i.a=l.exports},145:function(t,i,e){"use strict";var n=e(143);e.n(n).a},172:function(t,i,e){},173:function(t,i,e){},174:function(t,i,e){},175:function(t,i,e){},176:function(t,i,e){},217:function(t,i,e){"use strict";var n=e(172);e.n(n).a},219:function(t,i,e){"use strict";var n=e(173);e.n(n).a},221:function(t,i,e){"use strict";var n=e(174);e.n(n).a},223:function(t,i,e){"use strict";var n=e(175);e.n(n).a},225:function(t,i,e){"use strict";var n=e(176);e.n(n).a},282:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"collection"},[i("router-view")],1)};n._withStripped=!0;var s={name:"collection"},a=(e(217),e(2)),o=Object(a.a)(s,n,[],!1,null,"73d4b8ee",null);o.options.__file="src/components/views/collection/collection.vue";i.default=o.exports},284:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"collection-detail"},[e("div",{staticClass:"header"},[e("div",{staticClass:"left"},[e("CoverImage",{staticClass:"cover",attrs:{"image-src":t.coverImageUrl,size:"10xl"}})],1),t._v(" "),e("div",{staticClass:"center"},[t.isEditing?[e("div",{staticClass:"edit-title"},[e("p",[t._v("名称：")]),t._v(" "),e("label",{staticClass:"input",style:t.nameStyles,attrs:{"data-count":t.wordCountName}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.collection.name,expression:"collection['name']"}],attrs:{type:"text",autofocus:""},domProps:{value:t.collection.name},on:{input:function(i){i.target.composing||t.$set(t.collection,"name",i.target.value)}}})])]),t._v(" "),e("div",{staticClass:"edit-description"},[e("p",[t._v("简介：")]),t._v(" "),e("label",{staticClass:"input",style:t.descriptionStyles,attrs:{"data-count":t.wordCountDescription}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.collection.description,expression:"collection['description']"}],attrs:{rows:"2"},domProps:{value:t.collection.description},on:{input:function(i){i.target.composing||t.$set(t.collection,"description",i.target.value)}}})])])]:[e("div",{staticClass:"title"},[e("p",{directives:[{name:"title",rawName:"v-title"}]},[t._v("\n                        "+t._s(t.collection.name)+"\n                    ")])]),t._v(" "),e("div",{staticClass:"description-1"},[e("p",{directives:[{name:"title",rawName:"v-title"}]},[t.isLogged?[e("Thumbnail",{staticClass:"avatar",attrs:{src:t.userInfo.avatarSrc,"is-round":!0,"border-color":"white",size:"20px"}}),t._v(" "),e("span",[t._v(t._s(t.userInfo.username))]),t._v(" "),e("span",[t._v("2018-10-03 创建")])]:t._e(),t._v(" "),e("span",[t._v("共"+t._s(t.songsList.length)+"首")])],2)]),t._v(" "),e("div",{staticClass:"description-2"},[e("p",[t._v("\n                        简介：\n                        "),t.collection.description?e("span",{directives:[{name:"title",rawName:"v-title"}]},[t._v("\n                            "+t._s(t.collection.description)+"\n                        ")]):e("span",{staticClass:"link",on:{click:t.handleClickEdit}},[t._v("\n                            添加简介\n                        ")])])]),t._v(" "),e("div",{staticClass:"button-group"},[e("NormalButton",{staticClass:"button",attrs:{"icon-type":"play-2",highlight:!0},nativeOn:{click:function(i){return t.handlePlayAll(i)}}},[t._v("\n                        播放全部\n                    ")]),t._v(" "),e("NormalButton",{staticClass:"button",attrs:{"icon-type":"plus"},nativeOn:{click:function(i){return t.handleAddToPlaylist(i)}}},[t._v("\n                        加入队列\n                    ")])],1)]],2),t._v(" "),e("div",{staticClass:"right"},[t.isEditing?e("div",{staticClass:"button-group"},[e("NormalButton",{staticClass:"button",attrs:{"icon-type":"edit",active:!0},nativeOn:{click:function(i){return t.handleConfirmEdit(i)}}},[t._v("\n                    保存\n                ")]),t._v(" "),e("br"),t._v(" "),e("NormalButton",{staticClass:"button",attrs:{"icon-type":"cancel"},nativeOn:{click:function(i){return t.handleCancelEdit(i)}}},[t._v("\n                    放弃\n                ")])],1):e("div",{staticClass:"edit",on:{click:t.handleClickEdit}},[e("Icon",{attrs:{type:"edit",size:"lg"}}),t._v(" "),e("p",[t._v("编辑")])],1)])]),t._v(" "),e("SongList",{staticClass:"content",attrs:{"item-count":t.songsList.length,"height-type":"full","can-delete":!t.isEditing,"max-visible-item-count":Math.floor((t.height-(t.isEditing?310:280))/30)},on:{update:t.handleSongListUpdate}},[t._l(t.songsList,function(i,n){return e("SongListItem",{key:i.id,attrs:{collection:~~t.id,"playlist-type":"collection",type:"entity",song:i,theme:n%2==0?"white":"gray",index:n,"is-editing":t.isEditing,"is-cover":n===t.collection.cover},on:{delete:t.handleDelete,cover:t.handleCover,drop:t.handleDrop}})}),t._v(" "),e("template",{slot:"empty-text"},[t._v("\n            这里，空的\n        ")])],2),t._v(" "),e("transition",[e("NormalButton",{directives:[{name:"show",rawName:"v-show",value:t.isEditing,expression:"isEditing"}],staticClass:"delete",attrs:{"icon-type":"clear"},nativeOn:{click:function(i){return t.handleClickDelete(i)}}},[t._v("\n            删除歌单\n        ")])],1),t._v(" "),e("transition",[e("DialogBox",{directives:[{name:"show",rawName:"v-show",value:t.showDeleteConfirm,expression:"showDeleteConfirm"}],staticClass:"delete-confirm",on:{close:t.handleCloseDelete}},[e("Icon",{attrs:{slot:"title-icon",type:"information",size:"sm"},slot:"title-icon"}),t._v(" "),e("template",{slot:"title"},[e("span",[t._v("确认")])]),t._v(" "),e("template",{slot:"content-top"},[e("p",{staticClass:"first"},[t._v("\n                    即将删除 "+t._s(t.collection.name)+"\n                ")]),t._v(" "),e("p",[t._v("\n                    这个操作是不可撤销的！\n                ")])]),t._v(" "),e("template",{slot:"content-bottom"},[e("div",{staticClass:"button-group"},[e("NormalButton",{nativeOn:{click:function(i){return t.handleConfirmDelete(i)}}},[t._v("\n                        删除\n                    ")]),t._v(" "),e("NormalButton",{attrs:{active:!0},nativeOn:{click:function(i){return t.handleCloseDelete(i)}}},[t._v("\n                        放弃\n                    ")])],1)])],2)],1)],1)};n._withStripped=!0;var s=e(0),a=e.n(s),o=e(1),l=e.n(o),c=e(7),r=e.n(c),h=e(3),d=e(4),u=e(9),p=e(152),v=e(12),m=e(40),g=e(5),f=e(151),_=e(144),y={name:"collection-detail",components:{DialogBox:function(){return e.e(6).then(e.bind(null,13))},Thumbnail:v.a,SongListItem:f.a,NormalButton:_.a,SongList:p.a,Icon:g.a,CoverImage:m.a},directives:{Title:u.a},props:["id"],data:function(){return{collection:{},songsList:[],isEditing:!1,isNew:!1,initialSong:0,showDeleteConfirm:!1,inspect:!0}},computed:r()({},Object(d.c)(["userInfo"]),Object(d.b)("favorite",["favSongs"]),Object(d.b)("collection",["collectionOfId","collections"]),Object(d.b)(["isLogged","height"]),{wordCountName:function(){return 30-(this.collection.name||"").length},wordCountDescription:function(){return 60-(this.collection.description||"").length},nameStyles:function(){return this.wordCountName<0?{color:"#f74231"}:{}},descriptionStyles:function(){return this.wordCountDescription<0?{color:"#f74231"}:{}},coverImageUrl:function(){if(-1!==this.collection.cover&&this.songsList[this.collection.cover])return this.songsList[this.collection.cover].imageUrl}}),watch:{id:function(t){this.getCollection(t)},isEditing:function(t){t?this.$hasher.set("edit"):this.$hasher.remove("edit")}},methods:{getCollection:function(){var t=l()(a.a.mark(function t(i){var e,n=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("newPlaylist"!==i){t.next=9;break}return this.$hash.edit||this.$hasher.set("edit"),this.isNew=!0,this.collection={name:"新歌单",description:"这个人很简介， 没有懒惰。",playlist:this.initialSong?[this.initialSong]:[],cover:this.initialSong?0:-1},t.next=6,this.$ajax.getSongsSimpleAsync(this.collection.playlist);case 6:return t.t0=function(t){return r()({},t,{from:{name:"歌单：".concat(n.collection.name),url:n.$route.path}})},this.songsList=t.sent.map(t.t0),t.abrupt("return");case 9:if(this.isNew=!1,e=this.collectionOfId(i)){t.next=15;break}return this.$store.dispatch("addMessage",{type:"error",content:"404咯"}),this.$router.replace({name:"discover"}),t.abrupt("return");case 15:return this.collection=r()({},e),t.next=18,this.$ajax.getSongsSimpleAsync(this.collection.playlist);case 18:t.t1=function(t){return r()({},t,{from:{name:"歌单：".concat(n.collection.name),url:n.$route.path}})},this.songsList=t.sent.map(t.t1);case 20:case"end":return t.stop()}},t,this)}));return function(i){return t.apply(this,arguments)}}(),handlePlayAll:function(){this.isNew||this.$store.dispatch("playNewPlaylist",this.songsList)},handleAddToPlaylist:function(){this.isNew||this.$store.dispatch("addToPlaylist",{position:"head",song:this.songsList})},handleClickEdit:function(){this.isNew||(this.isEditing=!0)},handleConfirmEdit:function(){var t=l()(a.a.mark(function t(){var i,e;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i="",0!==this.collection.name.length){t.next=5;break}i="名称不可以为空",t.next=31;break;case 5:if(!(this.wordCountName<0)){t.next=9;break}i="名称过长",t.next=31;break;case 9:if(!(this.wordCountDescription<0)){t.next=13;break}i="简介过长",t.next=31;break;case 13:if(!this.isNew){t.next=26;break}return t.prev=14,t.next=17,this.$store.dispatch("createNewCollection",{name:this.collection.name,description:this.collection.description,playlist:this.songsList.map(function(t){return t.id}),cover:this.collection.cover});case 17:e=t.sent,this.$router.push({name:"collection-detail",params:{id:e}}),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(14),console.log(t.t0),this.$store.dispatch("addMessage",{type:"error",content:"创建新歌单时发生错误"});case 25:return t.abrupt("return");case 26:return this.$store.dispatch("setCollectionName",{id:this.id,name:this.collection.name}),this.$store.dispatch("setCollectionDescription",{id:this.id,description:this.collection.description}),this.$store.dispatch("setCollectionPlaylist",{id:this.id,playlist:this.songsList.map(function(t){return t.id})}),this.isEditing=!1,t.abrupt("return");case 31:this.$store.dispatch("addMessage",{type:"error",content:i});case 32:case"end":return t.stop()}},t,this,[[14,21]])}));return function(){return t.apply(this,arguments)}}(),handleCancelEdit:function(){this.isNew?this.$router.go(-1):(this.getCollection(this.id),this.isEditing=!1)},handleHashChange:function(t){this.isEditing=!0===t.edit,this.initialSong=~~t.initial,this.initialSong&&h.a.filterInteger(this.initialSong,1,1/0)!==this.initialSong&&(console.log(this.initialSong),this.$hasher.remove("initial"))},handleSongListUpdate:function(){this.getCollection(this.id)},handleCover:function(t){this.isEditing&&(this.collection.cover=t)},handleDelete:function(t){this.isEditing&&this.songsList.splice(t,1)},handleDrop:function(t){this.inspect&&(console.log("drop ".concat(t.drag," to ").concat(t.drop)),t.drag>t.drop?(this.songsList.splice(t.drop,0,this.songsList[t.drag]),this.songsList.splice(t.drag+1,1)):(this.songsList.splice(t.drop+1,0,this.songsList[t.drag]),this.songsList.splice(t.drag,1)))},handleClickDelete:function(){this.showDeleteConfirm=!0},handleCloseDelete:function(){this.showDeleteConfirm=!1},handleConfirmDelete:function(){this.showDeleteConfirm=!1,this.$store.dispatch("deleteCollection",this.id),this.$router.push({name:"discover"})}},mounted:function(){var t=this;this.handleHashChange(this.$hash),this.$hasher.bind(this.handleHashChange),this.getCollection(this.id),this.$watch("collections",function(){t.getCollection(t.id)},{deep:!0})},destroyed:function(){this.$hasher.unbind(this.handleHashChange)}},C=(e(219),e(2)),b=Object(C.a)(y,n,[],!1,null,"d4dc1980",null);b.options.__file="src/components/views/collection/collection-detail.vue";i.default=b.exports},288:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"playlist"},[e("PageHeader",{attrs:{layout:"icon","icon-type":"playlist-1"}},[e("template",{slot:"title"},[t._v("\n            播放队列\n        ")]),t._v(" "),e("template",{slot:"description"},[t._v("\n            "+t._s(t.playlist.length||"0")+" 首歌曲\n        ")])],2),t._v(" "),e("div",{staticClass:"playlist-indicator"},[t.played.length?e("p",[t._v("\n            向上滚动回忆 "+t._s(t.played.length)+" 首听过的歌\n        ")]):e("p",[t._v("\n            还没有听完一首歌呢\n        ")])]),t._v(" "),e("SongList",{staticClass:"playlist-song-list",attrs:{"height-type":"full","can-delete":!0,"item-count":t.listItemCount,"hidden-item-count":t.played.length,"max-visible-item-count":Math.floor((t.height-220)/30)}},[t._l(t.played,function(t,i){return e("SongListItem",{key:"played-"+t.id,attrs:{type:"entity",song:t,theme:"dark","playlist-type":"played",index:i}})}),t._v(" "),t._l(t.playlist,function(t,i){return e("SongListItem",{key:"playlist-"+t.id,attrs:{type:"entity",song:t,theme:i%2==0?"white":"gray","playlist-type":"playlist",index:i}})}),t._v(" "),e("template",{slot:"empty-text"},[t._v("\n            播放队列空空如也~\n        ")])],2),t._v(" "),e("NormalButton",{staticClass:"playlist-clear",attrs:{"icon-type":"clear"},nativeOn:{click:function(i){return t.handleClickClear(i)}}},[t._v("\n        清空…\n    ")])],1)};n._withStripped=!0;var s=e(7),a=e.n(s),o=e(4),l=e(152),c=e(151),r=e(144),h=e(47),d={name:"playlist",components:{NormalButton:r.a,SongListItem:c.a,SongList:l.a,PageHeader:h.a},computed:a()({},Object(o.b)("playlist",["played","playlist","noPlaying"]),Object(o.b)(["height"]),{listItemCount:function(){return this.played.length+this.playlist.length}}),methods:{handleClickClear:function(){this.$store.dispatch("clearPlaylist"),this.$store.dispatch("clearPlayed")}}},u=(e(221),e(2)),p=Object(u.a)(d,n,[],!1,null,"c7d1bfbc",null);p.options.__file="src/components/views/collection/playlist.vue";i.default=p.exports},290:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"collection-home"},[e("div",{staticClass:"wrapper"},[e("ul",[e("li",{directives:[{name:"title",rawName:"v-title"}],staticClass:"entrance-board valid",on:{click:function(i){t.handleClickLink("playlist")}}},[e("div",{staticClass:"icon-title"},[e("div",{staticClass:"icon-playlist"},[e("Icon",{attrs:{type:"playlist-1",size:"xl"}})],1),t._v(" "),e("div",{staticClass:"title"},[t._v("\n                        播放列表\n                    ")])]),t._v(" "),e("div",{staticClass:"description"},[t._v("即将播放、正在播放和播放过的歌曲")])]),t._v(" "),e("li",{directives:[{name:"title",rawName:"v-title"}],staticClass:"entrance-board valid",on:{click:function(i){t.handleClickLink("fav-song")}}},[e("div",{staticClass:"icon-title"},[e("div",{staticClass:"icon-favorite"},[e("Icon",{attrs:{type:"favorite-1",size:"xl"}})],1),t._v(" "),e("div",{staticClass:"title"},[t._v("\n                        我喜欢的音乐\n                    ")])]),t._v(" "),e("div",{staticClass:"description"},[t._v("大家都很好听，要选一个出来很困难啊")])]),t._v(" "),e("li",{directives:[{name:"title",rawName:"v-title"}],staticClass:"entrance-board"},[e("div",{staticClass:"icon-title"},[e("div",{staticClass:"icon-collection"},[e("Icon",{attrs:{type:"playlist-2",size:"xl"}})],1),t._v(" "),e("div",{staticClass:"title"},[t._v("\n                        我创建的歌单\n                    ")])]),t._v(" "),e("div",{staticClass:"description"},[t._v("从右侧歌单区选择一个我创建的歌单")])])])])])};n._withStripped=!0;var s=e(5),a=e(9),o={name:"collection-home",components:{Icon:s.a},directives:{Title:a.a},methods:{handleClickLink:function(t){this.$router.push({name:t})}}},l=(e(225),e(2)),c=Object(l.a)(o,n,[],!1,null,"145bbae4",null);c.options.__file="src/components/views/collection/collection-home.vue";i.default=c.exports},291:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"fav-song"},[e("PageHeader",{attrs:{layout:"image","image-src":t.favSongsList.length?t.favSongsList[0].imageUrl:void 0}},[e("template",{slot:"title"},[t._v("\n            我喜欢的音乐\n        ")]),t._v(" "),e("template",{slot:"description-1"},[t.isLogged?[e("Thumbnail",{staticClass:"avatar",attrs:{src:t.userInfo.avatarSrc,"is-round":!0,"border-color":"white",size:"20px"}}),t._v(" "),e("span",[t._v(t._s(t.userInfo.username))]),t._v(" "),e("span",[t._v("2018-09-24 创建")])]:t._e(),t._v(" "),e("span",[t._v("共"+t._s(t.myFavSongs.length)+"首")])],2),t._v(" "),e("template",{slot:"button"},[e("NormalButton",{staticClass:"button",attrs:{"icon-type":"play-2",highlight:!0},nativeOn:{click:function(i){return t.handlePlayAll(i)}}},[t._v("\n                播放全部\n            ")]),t._v(" "),e("NormalButton",{staticClass:"button",attrs:{"icon-type":"plus"},nativeOn:{click:function(i){return t.handleAddToPlaylist(i)}}},[t._v("\n                加入队列\n            ")])],1)],2),t._v(" "),e("SongList",{staticClass:"content",attrs:{"item-count":t.favSongsList.length,"height-type":"full","max-visible-item-count":Math.floor((t.height-280)/30)}},[t._l(t.favSongsList,function(t,i){return e("SongListItem",{key:t.id,attrs:{type:"entity",song:t,theme:i%2==0?"white":"gray",index:i}})}),t._v(" "),e("template",{slot:"empty-text"},[t._v("\n            这里，空的\n        ")])],2)],1)};n._withStripped=!0;var s=e(0),a=e.n(s),o=e(1),l=e.n(o),c=e(6),r=e.n(c),h=e(7),d=e.n(h),u=e(4),p=e(152),v=e(12),m=e(151),g=e(144),f=e(47),_={name:"fav-song",components:{Thumbnail:v.a,PageHeader:f.a,SongListItem:m.a,NormalButton:g.a,SongList:p.a},data:function(){return{favSongsList:[],myFavSongs:[]}},computed:d()({},Object(u.c)(["userInfo"]),Object(u.b)("favorite",["favSongs"]),Object(u.b)(["isLogged","height"])),watch:{favSongs:function(t){var i,e=this;(i=this.myFavSongs).push.apply(i,r()(t.filter(function(t){return!e.myFavSongs.includes(t)}))),this.getData()}},methods:{getData:function(){var t=l()(a.a.mark(function t(){var i=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax.getSongsSimpleAsync(this.myFavSongs);case 2:t.t0=function(t){return d()({},t,{from:{name:"我喜欢的音乐",url:i.$route.path}})},this.favSongsList=t.sent.map(t.t0);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handlePlayAll:function(){this.$store.dispatch("playNewPlaylist",this.favSongsList)},handleAddToPlaylist:function(){this.$store.dispatch("addToPlaylist",{position:"head",song:this.favSongsList})}},mounted:function(){var t=this;this.favSongs.forEach(function(i){t.myFavSongs.includes(i)||t.myFavSongs.push(i)}),this.getData()}},y=(e(223),e(2)),C=Object(y.a)(_,n,[],!1,null,"0b52ff52",null);C.options.__file="src/components/views/collection/fav-song.vue";i.default=C.exports}}]);